# <center> Architecture to CloudFormation template using Anthropic Claude 3 vision </center> 

## Description

Embracing the power of Claude 3 Vision, this project revolutionizes infrastructure deployment on AWS, offering a next-generation developer experience. Developers can effortlessly translate their architectural visions into reality by simply sketching their desired cloud solutions. Claude 3 Vision's advanced image understanding capabilities will analyze these diagrams and generate boilerplate AWS CloudFormation code, eliminating the need for initial complex coding tasks. This visual-driven approach empowers developers of all skill levels, fostering collaboration, rapid prototyping, and accelerated innovation.

> [!IMPORTANT]  
> The AWS CloudFormation template generated by the web applicaiton are intended for inspiration purposes and not for production-level applications. It is your responsibility as a developer to test and vet the CloudFormation template according to your security guidlines.


## Architecture

![architecture](/architecture.png)

0. Developer manually deploys [development.yaml](/development.yaml) stack to host Streamlit applicaiton on AWS Fargate. 
1. User uploads an architecture diagram on Streamlit app. This triggers Amazon Bedrock API to generate step-by-step explanation of the given architecture diagram using Anthropic Claude 3 model.
2. Anthropic Claude 3 model is invoked using step-by-step explanation and few shot learning examples to generate initial AWS CloudFormation code.
3. User provides update instruction, which is used to update the initial AWS CloudFormation code.

> [!NOTE]  
> Steps 1 and 2 are run only once when architecture diagram is uploaded. To trigger changes to the AWS CloudFormation code (step 3) provide update insturctions from StreamlitApp

## Prerequisite

An AWS Account, to deploy the infrastructure. You can find more instructions to create your 
account [here](https://aws.amazon.com/free).


> [!IMPORTANT]  
> To access a foundation model, the user must request access through the console. Follow the instructions documented [here](https://docs.aws.amazon.com/bedrock/latest/userguide/model-access.html).

## Deploy VPC Infrastructure (Optional)

Optionally, you can deploy the Virtual Private Cloud (VPC) infrastructure using the provided [infrastructure.yaml](/infrastructure.yaml) file, or utilize the default VPC. The required infrastructure components, including Amazon CloudFront, an Application Load Balancer, and Amazon Elastic Container Service (ECS) on AWS Fargate instances, will be deployed within the chosen VPC environment. 

> [!Note]  
> Wait for `infrastructure.yaml` to be in CREATE_COMPLETE state before moving forward. Make sure to use the same region for both `infrastructure.yaml` and `development.yaml` stacks. 

|   Region   | infrastructure.yaml |
| ---------- | ----------------- |
| us-east-1  | [![launch-stack](https://s3.amazonaws.com/cloudformation-examples/cloudformation-launch-stack.png)](https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/new?stackName=ArchToCloudformationInfra&templateURL=https://ws-assets-prod-iad-r-iad-ed304a55c2ca1aee.s3.us-east-1.amazonaws.com/0a9f7588-a2c4-4484-b051-6658ce32605c/A2C/infrastructure.yaml)|
| us-west-2  | [![launch-stack](https://s3.amazonaws.com/cloudformation-examples/cloudformation-launch-stack.png)](https://console.aws.amazon.com/cloudformation/home?region=us-west-2#/stacks/new?stackName=ArchToCloudformationInfra&templateURL=https://ws-assets-prod-iad-r-pdx-f3b3f9f1a7d6a3d0.s3.us-west-2.amazonaws.com/0a9f7588-a2c4-4484-b051-6658ce32605c/A2C/infrastructure.yaml)|

You can leave the parameters with default values. `infrastructure.yaml` stack will take 3-5 minutes to complete deployment.

## Deploy Web Application

### Step :one: Deploy [development.yaml](/development.yaml).

|   Region   | development.yaml |
| ---------- | ----------------- |
| us-east-1  | [![launch-stack](https://s3.amazonaws.com/cloudformation-examples/cloudformation-launch-stack.png)](https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/new?stackName=ArchToCloudformation&templateURL=https://ws-assets-prod-iad-r-iad-ed304a55c2ca1aee.s3.us-east-1.amazonaws.com/0a9f7588-a2c4-4484-b051-6658ce32605c/A2C/development.yaml)|
| us-west-2  | [![launch-stack](https://s3.amazonaws.com/cloudformation-examples/cloudformation-launch-stack.png)](https://console.aws.amazon.com/cloudformation/home?region=us-west-2#/stacks/new?stackName=ArchToCloudformation&templateURL=https://ws-assets-prod-iad-r-pdx-f3b3f9f1a7d6a3d0.s3.us-west-2.amazonaws.com/0a9f7588-a2c4-4484-b051-6658ce32605c/A2C/development.yaml)|

Make sure to provide values for following parameters:
1. VPCId: VPC for provisioning required infrastructure. 
2. PublicSubnetAId: Public subnet A with route to internet gateway. Application Load Balancer will be provisioned in public subnet. 
3. PublicSubnetBId: Public subnet B with route to internet gateway. Application Load Balancer will be provisioned in public subnet. 
4. PrivateSubnetAId: Private subnet A with route to NAT gateway. ECS tasks will be provisioned in private subnet. 
5. PrivateSubnetBId: Private subnet B with route to NAT gateway. ECS tasks will be provisioned in private subnet. 
6. EnvironmentName: Unique name to distinguish application in the same AWS account (min length 1 and max length 4); you can try `dev`, `test` or `prod`.

### Step :three: Viewing the app

After the successful completion of `development.yaml`. Get the CloudFront URL from the `Outputs` tab of the stack. Paste it in the browser to view the web application.

## Clean Up
- Open the CloudFormation console.
- Select the stack `infrastructure.yaml` you created then click **Delete** twice. Wait for the stack to be deleted.
- Select the stack `development.yaml` you created then click **Delete** twice. Wait for the stack to be deleted.

## Security

See [CONTRIBUTING](CONTRIBUTING.md#security-issue-notifications) for more information.

## License

This library is licensed under the MIT-0 License. See the LICENSE file.

